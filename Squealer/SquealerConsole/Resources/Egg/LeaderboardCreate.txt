/***********************************************

	How to create a leaderboard in SQL Server!

	INSTRUCTIONS (THIS IS THE WAY):
	
	Execute this script on a database of your choosing.

	Upon execution, three things will be created:
	1. dbo.Leaderboard (table)
	2. dbo.LeaderboardAdd (stored procedure)
	3. dbo.LeaderboardRead (stored procedure)

	Make sure all players have permission to execute 
	the two stored procedures, and share your
	connection string with them!
	
	NOTE: If these objects already exist, they will
	be dropped and recreated.

	ALSO NOTE: Yes, it's extremely easy to cheat
	and put whatever you want onto the leaderboard.
	But, that is the path to the Dark Side, and
	believe me when I tell you, they do not actually
	have cookies.

***********************************************/

if object_id('[dbo].[Leaderboard]','U') is not null
	drop table [dbo].[Leaderboard]
go
create table [dbo].[Leaderboard] (
	[Signature] char(3) not null
	, [Points] int not null
	, [ScoreDate] datetime not null
);
go

if object_id('[dbo].[LeaderboardAdd]','P') is not null
	drop procedure [dbo].[LeaderboardAdd]
go
create procedure [dbo].[LeaderboardAdd]
@Signature char(3)
,@Points int
as
begin
	insert
		[dbo].[Leaderboard] ([Signature],[Points],[ScoreDate])
	values
		(upper(@Signature),@Points,getdate())
	end
go

if object_id('[dbo].[LeaderboardRead]','P') is not null
	drop procedure [dbo].[LeaderboardRead]
go
create procedure [dbo].[LeaderboardRead]
@Limit int
as
begin
	select
		top (@Limit)
		l.[Signature]
		,l.[Points]
	from
		[dbo].[Leaderboard] l
	order by
		l.Points desc
		,l.ScoreDate desc
end
go

exec [dbo].[LeaderboardAdd] 'C3P',0;
exec [dbo].[LeaderboardAdd] 'R2D',2;
exec [dbo].[LeaderboardAdd] 'VDR',0;
exec [dbo].[LeaderboardAdd] 'LEI',100;
exec [dbo].[LeaderboardAdd] 'LUK',100;
exec [dbo].[LeaderboardAdd] 'HAN',50;
